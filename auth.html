<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width" />
<title>ãƒ­ã‚°ã‚¤ãƒ³</title>
<link rel="icon" href="https://mikatea.sakura.ne.jp/Adeline/auth/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="./auth_style.css">
<style>
    .form-container{max-width:460px;margin:40px auto;background:#fff;padding:2rem;border-radius:12px;box-shadow:0 4px 10px rgba(0,0,0,0.08)}
    .form-container h2{text-align:center;margin:0 0 1.2rem}
    label{display:block;margin-top:1rem;font-weight:600}
    input[type="email"],input[type="password"]{width:100%;padding:.75rem;font-size:1rem;margin-top:.3rem;border:1px solid #ccc;border-radius:8px;box-sizing:border-box}
    .btn{margin-top:1rem;width:100%;background:#3F88C5;color:#fff;border:none;padding:.9rem;font-size:1.05rem;border-radius:8px;cursor:pointer;font-weight:700}
    .btn:hover{background:#316fa0}
    .btn-google{background:#4285f4}
    .btn-google:hover{background:#366fca}
    .row{display:flex;gap:8px;margin-top:8px}
    .row .btn{flex:1}
    .help{font-size:.9rem;color:#666;margin-top:.5rem;text-align:center}
    .error{margin-top:.75rem;color:#c0392b;font-weight:600}
    .success{margin-top:.75rem;color:#2e7d32;font-weight:600}
</style>
</head>

<body>
<main>
    <div class="form-container">
    <h2>ğŸ” ãƒ­ã‚°ã‚¤ãƒ³</h2>

    <label>ãƒ¡ãƒ¼ãƒ«
        <input type="email" id="email" placeholder="you@example.com" required />
    </label>
    <label>ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰
        <input type="password" id="password" placeholder="******" required />
    </label>

    <div class="row">
        <button id="loginBtn" class="btn">ãƒ­ã‚°ã‚¤ãƒ³ï¼ˆEmail/Passwordï¼‰</button>
        <!-- <button id="googleBtn" class="btn btn-google" type="button">Googleã§ç¶šè¡Œ</button> -->
    </div>

    <div class="row">
        <a class="btn" href="./reset.html" style="text-align:center;">ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å†è¨­å®šã¯ã“ã¡ã‚‰</a>
    </div>

    <div class="help">
        ã‚¢ã‚«ã‚¦ãƒ³ãƒˆæœªä½œæˆï¼Ÿ <a href="./register.html">æ–°è¦ç™»éŒ²</a> /
        ãƒ›ãƒ¼ãƒ ã¸ <a href="../index/index.html">æˆ»ã‚‹</a>
    </div>
    <div id="msg"></div>
</div>
</main>

<!-- Firebase v10+ CDNï¼ˆãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ç‰ˆï¼‰ -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-app.js";
import {
    getAuth, onAuthStateChanged, signInWithEmailAndPassword,
    GoogleAuthProvider, signInWithPopup, sendPasswordResetEmail
} from "https://www.gstatic.com/firebasejs/10.12.4/firebase-auth.js";

// â˜…githubã‚¢ãƒƒãƒ—æ™‚ã«å¿˜ã‚Œãšæ¶ˆã™ã“ã¨ï¼â˜…
const firebaseConfig = {
    apiKey: "",
    authDomain: "",
    projectId: "",
    storageBucket: "",
    messagingSenderId: "",
    appId: "",
    measurementId: ""
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
    
const msg = document.getElementById("msg");
const showMsg = (text, ok=false) => {
    msg.textContent = text;
    msg.className = ok ? "success" : "error";
};

// ã™ã§ã«ãƒ­ã‚°ã‚¤ãƒ³æ¸ˆã¿ãªã‚‰ãƒ›ãƒ¼ãƒ ã¸
onAuthStateChanged(auth, user => { 
    if (user) location.href = "../start/start.html"; 
});


// Email/Password ãƒ­ã‚°ã‚¤ãƒ³
document.getElementById("loginBtn").addEventListener("click", async () => {
    const email = document.getElementById("email").value.trim();
    const password = document.getElementById("password").value;
    if (!email || !password) return showMsg("ãƒ¡ãƒ¼ãƒ«ã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚");

    try {
        await signInWithEmailAndPassword(auth, email, password);
        location.href = "../start/start.html";
    } catch (e) {
        const map = {
            "auth/invalid-email": "ãƒ¡ãƒ¼ãƒ«ã®å½¢å¼ãŒä¸æ­£ã§ã™ã€‚",
            "auth/user-disabled": "ã“ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ç„¡åŠ¹åŒ–ã•ã‚Œã¦ã„ã¾ã™ã€‚",
            "auth/user-not-found": "ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚",
            "auth/wrong-password": "ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒé•ã„ã¾ã™ã€‚",
        };
        showMsg(map[e.code] || `ãƒ­ã‚°ã‚¤ãƒ³ã«å¤±æ•—ã—ã¾ã—ãŸï¼š${e.code}`);
    }
});

</script>
</body>
</html>